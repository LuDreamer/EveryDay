<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <script>
    async function fetchAll(){
        try{
            const data1=await fetchData()
            const data2=await fetchData(data1)
            const data3=await fetchData(data2)
            console.log(data3);
        } catch(err){
            console.log(err);
        }
    }
    // 假设 fetchData 是一个返回 Promise 的异步函数（示例）
function fetchData(prevData) {
  return new Promise((resolve) => {
    setTimeout(() => {
      const result = prevData ? prevData + 1 : 1; // 模拟依赖前一个结果
      resolve(result);
    }, 500);
  });
}
    fetchAll()

    async function getUserOrders(){
      try{
        const token=await login('username','password')
        const userInfo = await getUserInfo(token); // 用 token 获取用户信息
    const orders = await getOrders(userInfo.id); // 用用户ID获取订单
    return orders;
      } catch(err){
        console.log("流程失败",err);
      }
    }
    // 1. 模拟登录接口（返回 token）
function login(username, password) {
  return new Promise((resolve, reject) => {
    setTimeout(() => {
      // 模拟登录成功，返回 token
      resolve("fake_token_123456");
      // 若登录失败：reject(new Error("用户名或密码错误"));
    }, 1000);
  });
}

// 2. 模拟获取用户信息接口（需要 token）
function getUserInfo(token) {
  return new Promise((resolve, reject) => {
    setTimeout(() => {
      if (token) {
        // 模拟获取成功，返回用户信息（含 id）
        resolve({ id: "user_789", name: "张三", token });
      } else {
        reject(new Error("token 无效"));
      }
    }, 800);
  });
}

// 3. 模拟获取订单接口（需要用户 id）
function getOrders(userId) {
  return new Promise((resolve, reject) => {
    setTimeout(() => {
      if (userId) {
        // 模拟获取成功，返回订单列表
        resolve([
          { id: "order_1", goods: "手机", price: 5000 },
          { id: "order_2", goods: "电脑", price: 8000 }
        ]);
      } else {
        reject(new Error("用户 id 无效"));
      }
    }, 1200);
  });
}

// 4. 调用函数执行流程
getUserOrders().then(orders => {
  console.log("最终订单列表：", orders);
});
        </script>
</body>
</html>