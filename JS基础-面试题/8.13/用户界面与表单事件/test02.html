<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <title>任务管理工具</title>
  <style>
    .custom-tooltip {
  --bs-tooltip-bg: var(--bd-violet-bg);
  --bs-tooltip-color: var(--bs-white);
  
}
    .container { max-width: 500px; margin: 20px auto; padding: 0 20px; }
    h1 { color: #333; }
    .search-box { margin: 15px 0; }
    #searchInput { width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; }
    .add-form { display: flex; gap: 10px; margin: 15px 0; }
    #taskInput { flex: 1; padding: 8px; border: 1px solid #ddd; border-radius: 4px; }
    button { padding: 8px 15px; background: #4CAF50; color: white; border: none; border-radius: 4px; cursor: pointer; }
    button:hover { background: #45a049; }
    #taskList { list-style: none; padding: 0; margin: 20px 0; max-height: 300px; overflow-y: auto; border: 1px solid #eee; border-radius: 4px; }
    #taskList li { padding: 10px; border-bottom: 1px solid #eee; display: flex; justify-content: space-between; align-items: center; }
    #taskList li.completed { text-decoration: line-through; color: #888; }
    .del-btn { background: #f44336; padding: 4px 8px; font-size: 12px; }
    .del-btn:hover { background: #d32f2f; }
    #scrollTip { color: #888; text-align: center; padding: 10px; display: none; }
  </style>
   <link rel="stylesheet" href="../../../css/bootstrap.css"> 
</head>
<body>
  <button type="button" class="btn btn-secondary"
        data-bs-toggle="tooltip" data-bs-placement="top"
        data-bs-custom-class="custom-tooltip"
        data-bs-title="This top tooltip is themed via CSS variables.">
  Custom tooltip
</button>
  <div class="container">
    <h1>任务管理工具</h1><div style="font-size: small;">Tip</div>
    <!-- 搜索框 -->
    <div class="search-box">
      <input type="text" id="searchInput" placeholder="搜索任务...">
    </div>
    <!-- 添加任务表单 -->
    <form id="addForm" class="add-form">
      <input type="text" id="taskInput" placeholder="请输入任务内容..." required>
      <button type="submit">添加任务</button>
    </form>
    <!-- 任务列表 -->
    <ul id="taskList"></ul>
    <!-- 滚动提示 -->
    <div id="scrollTip">已滚动到最底部</div>
  </div>

  <script>
    const tooltipTriggerList = document.querySelectorAll('[data-bs-toggle="tooltip"]')
const tooltipList = [...tooltipTriggerList].map(tooltipTriggerEl => new bootstrap.Tooltip(tooltipTriggerEl))
    // 请在这里编写代码实现需求
    const tasks=[]
    const searchInput=document.getElementById('searchInput')
    const addForm=document.getElementById('addForm')
    const taskInput=document.getElementById('taskInput')
    const taskList=document.getElementById('taskList')
    const scrollTip=document.getElementById('scrollTip')
    
    
    function renderTasks(filteredTasks){
      //清空列表，处理数据，渲染列表
      taskList.innerHTML=''

      //渲染过滤后的任务
      filteredTasks.forEach((task,index)=>{
        const li=document.createElement('li')
        //根据完成的状态添加类名
        if(task.completed){
          li.classList.add('completed')
        }
        li.innerHTML=`
        <span class="task-text">${task.content}</span>
          <button class="del-btn">删除</button>
        `
        //存储所引用于后续操作
        li.dataset.index=index
        taskList.appendChild(li)
      });
    }
    
    addForm.addEventListener('submit',(e)=>{
        e.preventDefault()
        const taskContent=taskInput.value.trim()
        if(taskContent){
            tasks.push({
                content:taskContent,
                completed:false
            })
            renderTasks(tasks)
            taskInput.value=''
            taskInput.focus()
        }
        
       
    })
    let num=0
    searchInput.addEventListener('input',()=>{
        //获取关键词
        const keyword=searchInput.value.trim().toLowerCase()
        //过滤任务
        const filtered=tasks.filter(task=>{
         return task.content.toLowerCase().includes(keyword)
        })
        num=filtered.length
        renderTasks(filtered)//重新渲染过滤后的结果
    })
    searchInput.addEventListener('keydown',(e)=>{
        if(e.key==='Enter'){
          alert(`满足搜索条件的有${num}个,按esc键快速清空`)
        }
        num=0

      })
    //任务状态切换和删除
      taskList.addEventListener('click',(e)=>{
        const target=e.target
        const li=target.closest('li')
        if(!li)return///不是列表项退出

        //获取键值
        const index=parseInt(li.dataset.index)

        //切换状态
        if(target.classList.contains('task-text')){
          tasks[index].completed=!tasks[index].completed
          renderTasks(tasks)
        }
        if(target.classList.contains('del-btn')){
          tasks.splice(index,1)//从数组中删除
          renderTasks(tasks)
        }
      })
      document.addEventListener('keydown',(e)=>{
        if(e.key==='Escape'){
          taskInput.value=''
          searchInput.value=''
          renderTasks(tasks)
        }
      })
      
  </script>
</body>
</html>